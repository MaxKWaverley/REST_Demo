*** Settings ***

Documentation  This is main page of myLogistic Project
Resource  ../libs.txt


*** Variables ***

# Registration elements
${REGISTER_LINK}  xpath=//a[@href='/user/register/']
${REGISTRATION_COMPANY}  name=company
${REGISTRATION_FNAME}  name=first_name
${REGISTRATION_LNAME}  name=last_name
${REGISTRATION_ADDRESS}  name=address
${REGISTRATION_PCODE}  name=postal_code
${REGISTRATION_CITY}  name=city
${REGISTRATION_PEXT}  name=phone_ext
${REGISTRATION_PNUMBER}  name=phone_number
${REGISTRATION_MEXT}  name=mobile_ext
${REGISTRATION_MNUMBER}  name=mobile_number
${REGISTRATION_FAX}  name=fax
${REGISTRATION_TNUMBER}  name=tax_number
${REGISTRATION_EMAIL}  name=email
${REGISTRATION_EMAIL2}  name=email2
${REGISTRATION_PASS}  name=password1
${REGISTRATION_PASS2}  name=password2
${REGISTRATION_AGREE_LINK}  xpath=//label[@for='id_is_agree_with_terms']
${REGISTRATION_SUBMIT_BUTTON}  xpath=(//button[@type='submit'])[2]

# General Sign In elements
${SIGNIN_BUTTON}  xpath=//a[contains(text(),'Sign In')]
${SIGNIN_USERNAME}  id=username
${SIGNIN_PASSWORD}  id=password
${SIGNIN_SUBMIT}  xpath=//button[@type='submit']

# Direct link Sign In elements
${DL_SIGNIN_USERNAME}  xpath=(//input[@name='username'])[2]
${DL_SIGNIN_PASS}  xpath=(//input[@name='password'])[2]
${DL_SIGNIN_SUBMIT_BUTTON}  xpath=(//button[@type='submit'])[2]

#Landing page items
${HOW_TEXT}  id=how_it_works
${ID_NAME}  id=id_name
${ID_EMAIL}  id=id_email
${ID_PHONE}  id=id_phone
${ID_TEXT}  id=id_text
${CLEARALL_BUTTON}  xpath=//input[@value='Clear all']
${SEND_BUTTON}  xpath=(//button[@type='submit'])[3]

*** Keywords ***

# Landing page section

Verify Main Page Opened
  [Documentation]  Checks that Mylogistic page is opened correctly
  Title Should Be  Mylogistic
  Page Should Contain Element  ${HOW_TEXT}

Input Contact Us Name on Main Page
  [Documentation]  Fillin' in Contact Us Name Field
  [Arguments]  ${text}
  Input Text  ${ID_NAME}  ${text}

Input Contact Us Email on Main Page
  [Documentation]  Fillin' in Contact Us Email Field
  [Arguments]  ${text}
  Input Text  ${ID_EMAIL}  ${text}

Input Contact Us Phone on Main Page
  [Documentation]  Fillin' in Contact Us Phone Field
  [Arguments]  ${text}
  Input Text  ${ID_PHONE}  ${text}

Input Contact Us Text on Main Page
  [Documentation]  Fillin' in Contact Us Message Field
  [Arguments]  ${text}
  Input Text  ${ID_TEXT}  ${text}

Click Clear All button in Contact Us form
  [Documentation]  Clicking Clear All button in Contact Us form on landing page
  Click Element  ${CLEARALL_BUTTON}

Click Send Button in Contact Us form
  [Documentation]  Clicking Send button in Contact Us form on landing page
  Click Element  ${SEND_BUTTON}

Checks that Contact Us info successfully sent
  [Documentation]  Checks that Contact Us info successfully sent
  Title Should Be  Contact us success


# General Sign In

Open Sign In form
  [Documentation]  Clicks Sign In button on landing page
  Click Element  ${SIGNIN_BUTTON}

Input Sign In Username
  [Documentation]  Input username in Sign In form on landing page
  [Arguments]  ${text}
  Input Text  ${SIGNIN_USERNAME}  ${text}

Input Sign In Password
  [Documentation]  Input password in Sign In form on landing page
  [Arguments]  ${text}
  Input Text  ${SIGNIN_PASSWORD}  ${text}

Click Sign In button
  [Documentation]  Clicks Sign In button in Sign In form on landing page
  Click Element  ${SIGNIN_SUBMIT}

Verify that Activity List is opened
  [Documentation]  Verification that Activity List is opened
  Location Should Contain  /user/activity/list/


# Direct link Sign In

Input Sign In Username for direct link
  [Documentation]  Input username in Sign In form for direct links
  [Arguments]  ${text}
  Input Text  ${DL_SIGNIN_USERNAME}  ${text}

Input Sign In Password for direct link
  [Documentation]  Input password in Sign In form for direct links
  [Arguments]  ${text}
  Input Text  ${DL_SIGNIN_PASS}  ${text}

Click Sign In button for direct link
  [Documentation]  Clicks Sign In button in Sign In form for direct links
  Click Element  ${DL_SIGNIN_SUBMIT_BUTTON}


#Registration

Open Registration form
  [Documentation]  Clicks Register link
  Click Element  ${REGISTER_LINK}

Input Registration Company
  [Documentation]  Input Registration Company value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_COMPANY}  ${text}

Input Registration First Name
  [Documentation]  Input First Name value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_FNAME}  ${text}

Input Registration Last Name
  [Documentation]  Input Last Name value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_LNAME}  ${text}

Input Registration Address
  [Documentation]  Input Address value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_ADDRESS}  ${text}

Input Registration Postal Code
  [Documentation]  Input Postal Code value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_PCODE}  ${text}

Input Registration City
  [Documentation]  Input City value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_CITY}  ${text}

Input Registration Phone Ext
  [Documentation]  Input Phone Ext value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_PEXT}  ${text}

Input Registration Phone Number
  [Documentation]  Input Phone number value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_PNUMBER}  ${text}

Input Registration Mobile Ext
  [Documentation]  Input Mobile Ext value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_MEXT}  ${text}

Input Registration Mobile Number
  [Documentation]  Input Mobile number value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_MNUMBER}  ${text}

Input Registration Fax
  [Documentation]  Input Fax value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_FAX}  ${text}

Input Registration Tax Number
  [Documentation]  Input Tax value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_TNUMBER}  ${text}

Input Registration Email
  [Documentation]  Input Email value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_EMAIL}  ${text}

Input Registration Email2
  [Documentation]  Input Email confirmation value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_EMAIL2}  ${text}

Input Registration Password
  [Documentation]  Input Password value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_PASS}  ${text}

Input Registration Password2
  [Documentation]  Input Password confirmation value in Registration form
  [Arguments]  ${text}
  Input Text  ${REGISTRATION_PASS2}  ${text}

Click on I agree with the Terms & Conditions checkbox
  [Documentation]  Clicks "I agree with the Terms & Conditions" checkbox in Registration form
  Click Element  ${REGISTRATION_AGREE_LINK}

Click Register button
  [Documentation]  Clicks Register button in Registration form
  Click Element  ${REGISTRATION_SUBMIT_BUTTON}

Checks that Registration completed successfully
  [Documentation]  Verification that Registration completed successfully
  Location Should Contain  /user/register/complete/ 


Email registration confimation
  [Documentation]  Open account activation link from "MyLogistic - Your Registration" email and checks that activation is successful
  Open Mailbox  server=imap.googlemail.com  user=${TEST_EMAIL}  password=${TEST_EMAIL_PASS}
  ${LATEST}  Wait for Mail  fromEmail=${TEST_EMAIL_FROM}  toEmail=${TEST_EMAIL}  timeout=120
  ${CONFIRMATION_TOKEN}  Get Matches From Email  ${LATEST}  ([0-9a-f]{40})
  ${CONFIRMATION_TOKEN}  Evaluate  ${CONFIRMATION_TOKEN}[0]  
  Open Browser  ${HOME_URL}user/activate/${CONFIRMATION_TOKEN}/
  Location Should Contain  /user/activate/complete/


Email change condition confirmation for unseen email
  [Arguments]  ${decision}  ${text}
  [Documentation]  Open accept/reject link from "Change condition confirmation" email and checks that activation is successful
  Open Mailbox  server=imap.googlemail.com  user=${TEST_EMAIL}  password=${TEST_EMAIL_PASS}
  ${LATEST}  Wait for Mail  fromEmail=${TEST_EMAIL_FROM}  toEmail=${TEST_EMAIL}  status=unseen  timeout=30
  ${CONFIRMATION_TOKEN}  Get Matches From Email  ${LATEST}  ([0-9a-f]{32})
  ${CONFIRMATION_TOKEN}  Evaluate  ${CONFIRMATION_TOKEN}[0]
  Mark as read
  Open Browser  ${HOME_URL}user/condition/${decision}/${CONFIRMATION_TOKEN}/
  Sign In to direct link
  Location Should Contain  ${text}

Email change condition confirmation for already read email
  [Arguments]  ${decision}  ${text}
  [Documentation]  Open accept/reject link from "Change condition confirmation" email and checks that activation is successful
  Open Mailbox  server=imap.googlemail.com  user=${TEST_EMAIL}  password=${TEST_EMAIL_PASS}
  ${LATEST}  Wait for Mail  fromEmail=${TEST_EMAIL_FROM}  toEmail=${TEST_EMAIL}  timeout=120
  ${CONFIRMATION_TOKEN}  Get Matches From Email  ${LATEST}  ([0-9a-f]{32})
  ${CONFIRMATION_TOKEN}  Evaluate  ${CONFIRMATION_TOKEN}[0]
  Open Browser  ${HOME_URL}user/condition/${decision}/${CONFIRMATION_TOKEN}/
  Sign In to direct link
  Location Should Contain  ${text}