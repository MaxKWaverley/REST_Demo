*** Settings ***

Documentation  Test suite for Main page
Resource  ../config.txt

Test Setup  Open Browser to Mylogistic Home Page  ${HOME_URL}  ${BROWSER}
Test Teardown  Close All Browsers

*** Test Cases ***

Open Create New Package page
  [Tags]  smoke
  Sign In as an autotest user
  Click Create New Package button
  Verify that Create Package page is opened

Creating National Package #1 verification
  [Tags]  smoke
  Sign In as an autotest user
  Click Create New Package button
  Verify that Create Package page is opened
  Input package to_company  To Company Name
  Input package to_contact  To Contact Name
  Input package to_phone  123456789
  Input package to_email  to@email.com
  Input package to_address  Sommerstraße 8, 28215
  Input package to_city  Bremen
  Input package to_postal  28215
  Input package length  12
  Input package height  12
  Input package width  12
  Input package weight  12
  Input package free_reference  Free Reference
  Check is_B2C checkbox
  Check UPS Carbon checkbox
  Check Height Insurance checkbox
  Input Height Insurance value  1234
  Click Create button
  Verify that Package Info is opened

Verify National Package #1 price
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Check that Package contains correct price  11.92

Verify National Package #1 name
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Check that Package name is correct  Sommerstraße 8, 28215

Verify National Package #1 weight
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Check that Package weight is correct  12.0

Add National Package #1 to cart, Creating Pickup and payment amount verification
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Click Add to Cart button
  Click Cart button
  Click Checkout button
  Verify that Pickup Create page is opened
  Click Pickup Create button in Pickup page
  Verify that actual payment price is  14.8

Verification Payment by PayPal for National Package #1
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Click Order button in Package Details page
  Click Payment button in Order Page 
  Click Payment by PayPal button
  Select already existed account in PayPal
  Input PayPal email  fevent_dev@mediasapiens.co
  Input PayPal Password  HuM62YgMRTmMsg
  Click LogIn button in PayPal
  Click Confirm payment button
  Verify that Transaction is completed successfully  Transaction complete 

Paid Order #1 verification
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Click Order button in Package Details page
  Verify that Order #1 is already paid. And amount is  14.80

Verification "Pickup create" state for National Package #1
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  Pickup create  

Get National Package #1 number 
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  ${P_NUMBER_CURRENT}=  Get Package #1 number
  Connect MySQL for MyLogistic
  ${P1_ID}=  Get id for current package  ${P_NUMBER_CURRENT}
  Set Global Variable  ${P1_ID}  ${P1_ID}

Set National Package #1 to "In Transit" state
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Set "In Transit" state for package  ${P1_ID}
  Connect SSH to MyLogistic 
  Force Update Server state via SSH

Verification "In Transit" state for National Package #1
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  In Transit 

Set National Package #1 to "ORIGIN SCAN" state
  [Tags]  temp
  Connect MySQL for MyLogistic
  Set "ORIGIN SCAN" state for package  ${P1_ID}
  Connect SSH to MyLogistic 
  Force Update Server state via SSH

Verification "ORIGIN SCAN" state for National Package #1
  [Tags]  temp
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  ORIGIN SCAN 

Set National Package #1 to "Pickup" state
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Set "2nd Delivery attempt" state for package  ${P1_ID}
  Connect SSH to MyLogistic 
  Force Update Server state via SSH

Verification "Pickup" state for National Package #1
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  Pickup 

Set National Package #1 to "Delivered" state
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Set "Delivered" state for package  ${P1_ID}
  Connect SSH to MyLogistic 
  Force Update Server state via SSH

Verification "Delivered" state for National Package #1
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  Delivered 
  