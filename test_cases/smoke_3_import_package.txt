*** Settings ***

Documentation  Test suite for Main page
Resource  ../config.txt

Test Setup  Open Browser to Mylogistic Home Page  ${HOME_URL}  ${BROWSER}
Test Teardown  Close All Browsers

*** Test Cases ***

Creating Import Package #3 verification
  [Tags]  smoke
  Sign In as an autotest user
  Click Create New Package button
  Verify that Create Package page is opened
  Select to_country  Monaco
  Input package to_company  To Company Name
  Input package to_contact  To Contact Name
  Input package to_phone  123456789
  Input package to_email  to@email.com
  Input package to_address  Monte-Carlo
  Input package to_city  Monte-Carlo
  Input package to_postal  98000
  Click UPS Shipment Type drop-down
  Select UPS Express Shipment Type
  Input package length  80
  Input package height  80
  Input package width  10
  Input package weight  8
  Input package free_reference  Export Free Reference
  Check Height Insurance checkbox
  Input Height Insurance value  1200
#  Click From To Swap Button
  Click Create button
  Verify that Package Info is opened

Verify Import Package #3 price
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Check that Package contains correct price  151.41

Verify Import Package #3 name
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Check that Package name is correct  Monte-Carlo, Monte-Carlo 98000

Verify Import Package #3 weight
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Check that Package weight is correct  8.0

Activation Invoice Payment
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Activate payment by Invoice option for selected user with required amount  1001

Activation Invoice Payment Verification
  [Tags]  smoke
  Go to User Profile page
  Sign In to direct link
  Check that Invoice Limit is correct  1001

Invoice Remaining verification
  [Tags]  smoke
  Go to User Profile page
  Sign In to direct link
  Check that Invoice Remaining is correct  1001
  
Add Import Package #3 to cart, create pickup, payment verification - Invoice
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Click Add to Cart button
  Click Cart button
  Click Checkout button
  Verify that Pickup Create page is opened
  Click Pickup Create button in Pickup page
  Click Payment Method drop-down
  Select Invoice Payment method
  Verify that actual payment price is  180.18

Verification Payment by Invoice for Import Package #3
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Click Order button in Package Details page
  Click Payment button in Order Page
  Click Payment Method drop-down
  Select Invoice Payment method
  Click Payment by Invoice button

Invoice Limit Verification after virtual payment
  [Tags]  smoke
  Go to User Profile page
  Sign In to direct link
  Check that Invoice Limit is correct  1001

Invoice Remaining verification after virtual payment 
  [Tags]  smoke
  Go to User Profile page
  Sign In to direct link
  Check that Invoice Remaining is correct  849.59

Set IS_PAID status for Invoice payment
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Set IS_PAID for Invoice order

Paid Order #3 verification
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  Click Order button in Package Details page
  Verify that Order #1 is already paid. And amount is  180.18
  
Invoice Limit Verification after real payment
  [Tags]  smoke
  Go to User Profile page
  Sign In to direct link
  Check that Invoice Limit is correct  1001

Invoice Remaining verification after real payment
  [Tags]  smoke
  Go to User Profile page
  Sign In to direct link
  Check that Invoice Remaining is correct  1001

Verification "Pickup create" state for Import Package #3
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  Pickup create  

Get Import Package #3 ID
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details
  ${P_NUMBER_CURRENT}=  Get Package #1 number
  Connect MySQL for MyLogistic
  ${P3_ID}=  Get id for current package  ${P_NUMBER_CURRENT}
  Set Global Variable  ${P3_ID}  ${P3_ID}

Set Import Package #3 to "In Transit" state
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Set "In Transit" state for package  ${P3_ID}
  Connect SSH to MyLogistic 
  Force Update Server state via SSH

Verification "In Transit" state for Import Package #3
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  In Transit 

Set National Package #3 to "Pickup" state
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Set "2nd Delivery attempt" state for package  ${P3_ID}
  Connect SSH to MyLogistic 
  Force Update Server state via SSH

Verification "Pickup" state for National Package #3
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  Pickup

Set Import Package #3 to "Delivered" state
  [Tags]  smoke
  Connect MySQL for MyLogistic
  Set "Delivered" state for package  ${P3_ID}
  Connect SSH to MyLogistic 
  Force Update Server state via SSH

Verification "Delivered" state for Import Package #3
  [Tags]  smoke
  Sign In as an autotest user
  Open Package #1 Details  
  Verify that Package Current State is  Delivered 